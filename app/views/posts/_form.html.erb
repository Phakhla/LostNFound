<div class="container">
<%= simple_form_for post, data: { controller: 'maps' } do |f| %>
  <%= f.error_notification %>

  <%= f.hidden_field :status, value: 'active' %>
  <%= f.hidden_field :category %>
  <%= f.hidden_field :lat, data: { maps_target: "latitude" } %>
  <%= f.hidden_field :lng, data: { maps_target: "longitude" } %>
  <%= f.hidden_field :location, data: { maps_target: "address" } %>

  <%= f.label :name, "หัวข้อประกาศ" %>
  <%= f.input :name %>

  <%= f.label :type_id, "หมวดหมู่" %>
  <%= f.select :type_id, Type.all.map{ |l| [l.type_name, l.id] } %>

  <%= f.input :date, as: :datetime, html5: true %>

  <%= f.label :images, "อัปโหลดรูป" %>
  <div class="dropzone dropzone-default dz-clickable"  data-controller="dropzone" data-dropzone-max-file-size="2" data-dropzone-max-files="4">
    <%= f.file_field :images, multiple: true, direct_upload: true, data: { target: 'dropzone.input' } %>
    <div class="dropzone-msg dz-message">
      <h3 class="dropzone-msg-title">Drag here to upload or click here to browse</h3>
      <span class="dropzone-msg-desc text-sm">2 MB file size maximum. Allowed file types png, jpg.</span>
    </div>
  </div>

  <%= f.label :detail, "รายละเอียดเพิ่มเติม" %>
  <%= f.input :detail %>

  <div class="mt-3">
    <label class="form-label">สถานที่ที่เจอ</label>
  </div>

  <div class="form-group mb-3">
    <%= f.input :search, input_html: { data: { maps_target: "field", action: "keydown->maps#preventSubmit" }, value: '' } %>
  </div>

  <%= content_tag :div, nil, data: { action: 'google-maps-callback@window->maps#initializeMap', maps_target: "map" }, class: 'map mb-5' %>

  <% if post.errors.key?(:lat) || post.errors.key?(:lng)  %>
    <p class="text-danger">Please select location.</p>
  <% end %>

  <%= f.button :button, "ยกเลิก", type: "reset", class: "btn-outline-secondary" %>
  <%= f.button :button, "สร้างโพสต์", type: "submit", class: "btn-primary" %>
<% end %>


</div>
